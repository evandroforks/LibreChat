version: "3.4"

# Do not edit this file directly. Use a ‘docker-compose.override.yaml’ file if you can.
# Refer to `docker-compose.override.yaml.example’ for some sample configurations.

services:
  api:
    container_name: LibreChat
    ports:
      - "127.0.0.1:3080:3080"
    # depends_on:
    #   - mongodb
    # image: mylibrechat-dev
    build:
      context: .
      dockerfile: Dockerfile
    restart: always
    # user: "${UID}:${GID}"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      - PORT=3080
      - HOST=0.0.0.0
      - NODE_ENV=production
      - MONGO_URI=mongodb://mongodb:27017/LibreChat
      - MEILI_HOST=http://meilisearch:7700
    volumes:
      - ./.env:/app/.env
      - ./librechat.yaml:/app/librechat.yaml
      #- ./letsencrypt:/etc/letsencrypt
      #- ./client/nginx.conf:/etc/nginx/conf.d/default.conf
      - ./containerdata/images:/app/client/public/images
      - ./containerdata/uploads:/app/uploads
      # - ./containerdata/logs:/app/api/logs
  # mongodb:
  #   container_name: chat-mongodb
  #   image: mongo
  #   restart: always
  #   user: "${UID}:${GID}"
  #   volumes:
  #     - ./data-node:/data/db
  #   command: mongod --noauth
  # meilisearch:
  #   container_name: chat-meilisearch
  #   image: getmeili/meilisearch:v1.6
  #   restart: always
  #   user: "${UID}:${GID}"
  #   environment:
  #     - MEILI_HOST=http://meilisearch:7700
  #     - MEILI_NO_ANALYTICS=true
  #   volumes:
  #     - ./meili_data_v1.6:/meili_data
